parameters:
  - name: resourceConfiguration
    type: object

steps:
  - task: CopyFiles@2
    inputs:
      sourceFolder: 'src\scripts\infrastructure\${{ parameters.resourceConfiguration.type }}'
      contents: '**' 
      targetFolder: '$(Build.ArtifactStagingDirectory)\infrastructure\${{ parameters.resourceConfiguration.type }}'
    displayName: 'Copy Infrastructure'

  - task: CopyFiles@2
    inputs:
      sourceFolder: 'src\scripts\infrastructure\tests'
      contents: '**' 
      targetFolder: '$(Build.ArtifactStagingDirectory)\infrastructure\${{ parameters.resourceConfiguration.type }}'
    displayName: 'Copy Infrastructure'

  - task: PublishBuildArtifacts@1
    inputs:
      pathtoPublish: '$(Build.ArtifactStagingDirectory)\infrastructure\'
      artifactName: infrastructure
    displayName: 'Publish Infrastructure'